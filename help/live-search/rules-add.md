---
title: 添加规则
description: 了解如何创建搜索促销规则。
exl-id: 7175ccf7-d838-43b0-a176-957e7db040e0
source-git-commit: 085eb0fa1a278701cc889d219db7e8571327a632
workflow-type: tm+mt
source-wordcount: '2067'
ht-degree: 0%

---

# 添加规则

要构建规则，第一步是使用规则编辑器定义购物者的查询文本中触发关联事件的条件。 然后，完成规则详细信息，测试结果并发布规则。

## 添加规则

1. 在管理员中，转到&#x200B;**营销** > SEO和搜索> **[!DNL Live Search]**。
1. 设置&#x200B;**范围**&#x200B;以标识应用规则的[存储视图](https://experienceleague.adobe.com/docs/commerce-admin/start/setup/websites-stores-views.html#scope-settings)。
1. 单击&#x200B;**搜索促销**&#x200B;工作区。
1. 单击&#x200B;**添加规则**&#x200B;以启动规则编辑器。

## 规则类型

搜索查询是定义特定搜索词、条件和排名类型的位置。

可以设置应用于所有查询的默认规则，除非定义了更具体的搜索查询。 只能设置一个默认规则，且不能包含任何条件。 如果选择“缺省”，则不显示“条件”界面。
选择默认智能排名类型以及要应用于所有默认搜索的任何手动排名。 始终应用手动排名。

## 条件

条件是触发事件的要求。 一个规则最多可以有10个条件和25个事件。 默认规则不能包含任何条件。

![规则 — 生成您的规则](assets/rules-add-workspace.png)

>[!NOTE]
>
>目前，无法将规则定位到特定的客户组。

### 单个条件

1. 在&#x200B;*生成您的规则*&#x200B;下，选择要满足的&#x200B;**条件**，然后按照说明完成该语句。

   * 搜索查询包含 — 输入购物者查询中必须包含的文本字符串。 匹配设置确定购物者的查询与目录匹配的程度。 选项：<br />任意 — 购物者的查询文本的任何部分都可以匹配条件。<br />全部 — 购物者的所有查询都必须符合条件。
   * 搜索查询为 — 输入与购物者的查询完全匹配的文本字符串。 例如：“yoga pants”。 具有`Search query is`且匹配`All`的规则只能有一个条件。
   * 搜索查询开头为 — 输入必须在购物者查询开头的字符或文本字符串。
   * 搜索查询结尾为 — 输入必须在购物者查询末尾的字符或文本字符串。

   结果会立即显示在&#x200B;*测试您的规则*&#x200B;窗格中，并按优先级进行编号。 您可以使用上方的每行&#x200B;*个结果*&#x200B;滑块    用于更改每行的产品数量。

   ![规则 — 简单](assets/rule-simple-test.png)

1. 若要测试其他查询，请更改&#x200B;*测试您的规则*&#x200B;搜索框中的查询文本，然后按&#x200B;**返回**。
最初，测试窗格从“条件”搜索框中呈现查询。 但现在，它从测试查询框呈现查询。 测试窗格一次只呈现一个查询。
1. 如果您喜欢该结果，请更新&#x200B;*条件*&#x200B;搜索框中的文本。 然后，单击页面上的任意位置以更新测试窗格中的结果。
1. 要构建具有一个条件的简单规则，请转到步骤3： [添加事件](#events)。

### 多个条件

1. 要生成包含多个条件的规则，请单击&#x200B;**添加条件**。
一个规则最多可以有10个条件。 连接两个条件的逻辑运算符基于当前*匹配*&#x200B;设置。 默认情况下，*匹配*&#x200B;为`All`，逻辑运算符为`AND`。

1. 选择第二个条件并输入所需的查询文本。

1. 要更改规则的逻辑，请更改&#x200B;**匹配**&#x200B;设置以确定购物者的搜索条件与查询条件的匹配程度。 将&#x200B;**Match**&#x200B;设置为以下项之一：

   * 任意 — （默认）规则中的所有逻辑运算符都设置为`OR`，结果显示在测试窗格中。
   * 全部 — 规则中的所有逻辑运算符均设置为`AND`，结果将显示在测试窗格中。

   *Match*&#x200B;值确定用于连接多个条件的逻辑运算符。 更改&#x200B;*Match*&#x200B;设置将更改规则中的所有逻辑运算符。 无法在同一规则中组合`AND`和`OR`。

   在本例中，不是搜索“yoga pants”，而是有两个单独的查询来搜索“yoga”或“pants”。 此规则的具体性较低，在店面触发的频率高于其他规则。

   ![规则 — 匹配](assets/rules-match.png)

1. 要添加其他条件，请单击&#x200B;**添加条件**&#x200B;并重复该过程。

## 智能排名

智能排名将用户行为和网站统计数据相结合，以确定产品排名。
商店所有者可以设置以下类型的排名策略：

![规则 — 匹配](assets/rules-ranking-type.png)

* 购买次数最多：此指标按过去7天内每个SKU的总购买次数对产品进行排名。
* 添加到购物车次数最多 — 按照过去7天中的“添加到购物车”活动总数进行排名。
* 查看次数最多：对过去7天内每个SKU的总查看次数进行排名。
* 为您推荐 — 使用`viewed-viewed`数据点 — 查看此SKU的购物者也查看了这些其他SKU。
* 趋势：对于后台事件，回顾过去72小时的页面查看事件；对于前台事件，回顾过去24小时的页面查看事件。
* 无：产品按相关性排序。

选择规则的策略类型。 **测试您的规则**&#x200B;窗口显示预期的结果。

### 智能排名评分的工作原理

智能排名通过组合两个关键因素来确定最终产品订单：**文本相关性**&#x200B;和&#x200B;**行为信号**。 了解这些因素如何相互作用有助于您为搜索结果设置现实的期望。

**评分组件：**

* **文本相关性**：得分中的主导因素。 这会测量产品名称、描述和属性与搜索查询的匹配程度。 文本相关性得分是无界的（没有特定的上限），并且受以下因素影响：

   * 匹配单词出现的频率。
   * 产品名称/说明的长度（以字为单位）。

* **行为信号**：在文本相关性得分之上应用的有界提升。 当您选择“查看次数最多”或“购买次数最多”等智能排名策略时，具有更高行为信号的产品会获得得分的固定提升。 然而，这种提升有一个明确的限制。

**为什么查看次数最多的产品可能不会首先显示：**

文本相关性通常主导排名，因为其分数不受限制，而行为提升是固定的。 因此，具有强文本匹配的产品通常比那些具有较高参与信号的产品更出色。 行为增强本身可能无法弥补文本相关性的巨大差距。 智能排名通过同时考虑匹配质量和购物者互动来解决这个问题，从而提高整体相关性。 但是，文本匹配质量仍然是排名的主要驱动因素。

**示例：**

商户使用“查看次数最多”的智能排名策略并搜索“蜡烛”。 他们预计产品SKU YAN-K-E-512会显示在结果顶部，因为它具有最高的查看计数。 然而，其他产品的排名更高：

* **Texas Candle** （第1个位置）：具有更短、更干净的产品名称，这会产生非常高的文本相关性分数。 尽管它的观看次数比YAN-K-E-512少，但是其优越的文本匹配超过了行为提升。

* **YAN-K-E-512**（较低位置）：尽管在“查看次数最多”行为数据中拥有最高的查看百分位数，但其基于SKU的复杂名称会生成较低的文本相关性分数。 固定行为提升不足以克服文本相关性差距。

请参阅[搜索规则](./best-practice.md#search-rules)，了解如何使用规则提高产品可查找性。

### 注意事项

* 查询中的撇号和引号可能会导致某些语言中的排名和相关性出现一些小问题。
* 为确保智能排名正常工作，请确保用于搜索或筛选(Facet)的任何产品属性的&#x200B;**搜索权重**&#x200B;为`5`或更小。 要在[!DNL Commerce]管理员中查找此设置，请执行以下操作：

   1. 选择&#x200B;**商店** > _属性_ > **产品**。
   1. 搜索属性，如“name”。
   1. 在&#x200B;**属性信息** > **店面属性**&#x200B;页面中，将搜索权重设置为小于或等于`5`。

      ![产品 — 搜索权重](assets/set-search-weight.png)

>[!NOTE]
>
>店面搜索体验受多个配置协作的影响，例如彩块化、同义词和搜索/类别促销规则，这可能会导致结果与在“管理员”中测试单个配置时看到的结果不同。 虽然管理员测试可隔离特定配置区域，但店面可一起应用所有相关配置，从而生成更复杂和更真实的搜索输出。

## 手动排名

手动排名（以前称为事件）是在满足定义的条件时修改搜索结果的操作。 单个规则最多可以包含25个事件。

* 提升 — 将产品在搜索结果中向上移动。
* Bury — 将SKU在搜索结果中下移。
* 固定产品 — 产品显示在页面上选定的“位置”中。
* 隐藏产品 — 从搜索结果中排除SKU。

固定产品的最简单方法是拖放。

1. 在“测试”窗格中单击并拖动产品。 将其拖放到所需位置。 产品和位置字段会自动填充到“事件”窗格中。

   ![规则 — 匹配](assets/rule-event-pin-product.png)

您还可以单击大头针图标以将产品固定到其当前位置。 使用省略号上下文菜单“固定到顶部”或“固定到底部”。

>[!NOTE]
>
>您只能固定查询中返回的产品。

或者，可以手动设置事件：

1. 在&#x200B;*Events*&#x200B;下，选择满足相关条件时要发生的&#x200B;**Event**。

   例如，选择`Hide a product`。 然后，输入要隐藏的产品名称。 产品随您的键入一起推荐。

1. 对于多个事件，选择满足条件时要触发的任何其他事件。

## 其他详细信息

此处输入的信息显示在[规则详细信息](rules-workspace.md)面板中。

1. 在&#x200B;*详细信息*&#x200B;下，输入规则的&#x200B;**名称**。 所有规则名称必须唯一。
1. 输入规则的简短&#x200B;**描述**。
1. 输入规则要处于活动状态的&#x200B;**开始日期**&#x200B;和&#x200B;**结束日期**，或从日历中选择日期。

   要选择日期范围，请单击第一个日期，然后拖动以选择范围。

   ![规则 — 完成](assets/rule-add-details.png)

## 最终确定规则

1. 在测试窗格中检查规则的结果。
1. 如果规则具有多个查询，请测试每个可能受规则影响的查询。
1. 完成后，单击&#x200B;**保存并发布**。

   该规则已添加到&#x200B;*规则*&#x200B;工作区中的列表。

   >[!IMPORTANT]
   >
   >如果&#x200B;**[!UICONTROL Save and publish]**&#x200B;按钮呈灰显状态，请确保已输入规则的所有必需信息，包括规则名称。

1. 虽然活动规则会立即生效，但您最多可能必须等待15分钟才能刷新店面中的缓存查询结果。

>[!NOTE]
>
>当选择默认排序顺序“排序依据：最相关”时，规则和手动排名产品将应用于搜索结果。 如果购物者将排序顺序更改为诸如按名称或价格排序，则规则和手动排名不再有效。

## 字段描述

### 条件(if)

| 条件 | 描述 |
|--- |--- |
| 搜索查询包含 | 购物者的查询中包含的字符或文本字符串。 购物者的查询只需要匹配单个字符即可满足此条件。 |
| 搜索查询为 | 与购物者的查询完全匹配的字符或文本字符串。 使用此条件时，无法组合具有多个条件的复杂查询。 |
| 搜索查询始于 | 购物者的查询以此字符或文本字符串开头。 |
| 搜索查询结束于 | 购物者的查询以这个字符或文本字符串结尾。 |

### 逻辑运算符

| 操作员 | 描述 |
|--- |--- |
| 或者 | （默认）逻辑运算符`OR`比较两个条件并满足在至少有一个条件为true时触发事件的要求。 |
| 和 | 逻辑运算符`AND`比较两个条件并满足触发事件的要求（如果两个条件均为true）。 |

### 匹配运算符

| 操作员 | 描述 |
|--- |--- |
| 任何 | 将规则中的所有逻辑运算符更改为`OR`并返回匹配产品集。 |
| 全部 | 将规则中的所有逻辑运算符更改为`AND`并返回匹配产品集。 |

### 手动排名

| 事件 | 描述 |
|--- |--- |
| 提升 | 在搜索结果中将SKU或SKU范围移到较高的位置。 每个报表在测试搜索结果中均标有“已提升”预览徽章。 |
| Bury | 将搜索结果中的SKU或SKU范围下移。 每个页面在测试搜索结果中均标有“掩埋”预览徽章。 |
| 固定产品 | 将单个SKU附加到搜索结果中的特定位置。 产品在测试搜索结果中标有“已固定”预览徽章。 |
| 隐藏产品 | 从搜索结果中排除SKU或SKU范围。 |

### 详细信息

| 字段 | 描述 |
|--- |--- |
| 名称 | 规则的名称。 规则名称必须唯一。 |
| 规则类型 | 默认或查询。 除非定义了更具体的查询规则，否则默认应用于所有规则。 |
| 开始日期 | 规则的开始日期（如果已计划）。 |
| 结束日期 | 规则的结束日期（如果已计划）。 |
| 描述 | 规则的简要说明。 |
